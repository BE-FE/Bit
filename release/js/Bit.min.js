!function(t,r){"function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=r(t):"function"==typeof define&&define.amd?define("Bit",function(){return r(t)}):(t.dcodeIO=t.dcodeIO||{}).Bit=r(t)}(this,function(){var t=function(t){if(t%4!==0)throw new RangeError("The length must be a multiple of 4!");this.bitArray=new Array(t);for(var r=0,n=this.bitArray.length;n>r;r++)this.bitArray[r]=!1;this.length=t,this.currentOffset=-1,this.islittleEndian=!1};t.fromHex=function(r){return new t(4*r.length).writeHex(r,0,4*r.length,!0)};var r={Binarify:function(t){return"0"===t&&(t=null),!!t},Intify:function(t){return t?1:0}},n=t.prototype;return n.writeBit=function(t){return arguments[0]=t.bitArray,this.writeBitArray.apply(this,arguments)},n.writeString=function(){return arguments[0]=arguments[0].toString(2).split(""),this.writeBitArray.apply(this,arguments)},n.writeInteger=function(){return this.writeString.apply(this,arguments)},n.writeUTF8String=function(){return arguments[0]=Array.prototype.concat.apply([],arguments[0].split("").map(function(r){return new t(8).write(r.charCodeAt().toString(2),0,8,!0).bitArray})),this.writeBitArray.apply(this,arguments)},n.writeUTF16String=function(){return arguments[0]=Array.prototype.concat.apply([],arguments[0].split("").map(function(r){return new t(16).write(r.charCodeAt().toString(2),0,16,!0).bitArray})),this.writeBitArray.apply(this,arguments)},n.writeHex=function(){return arguments[0]=parseInt(arguments[0],16),this.writeInteger.apply(this,arguments)},n.writeBitArray=function(t,n,i,e){var s,a=t.length;if(e=!(!e&&!this.islittleEndian),this.currentOffset<0&&(this.currentOffset=0),n>-1){if(n>this.length)return this}else n=this.currentOffset,i>-1&&(i=n+i);if(!(i>-1)||n>=i)n+a>this.length?(i=this.length,t.splice(i-n-a)):i=n+a;else{var o=Math.min(i,this.length,n+a);a>o-n?(t.splice(o-n-a),i=o):i=Math.min(i,this.length)}return a=t.length,s=e?i-n-a:0,Array.prototype.splice.apply(this.bitArray,[n+s,a].concat(t.map(r.Binarify))),this.mark(i),this.lastWrittenBegin=n,this.lastWrittenEnd=i,this},n.write=function(t){return"[object Object]"===Object.prototype.toString.call(t)&&"bitArray"in t?this.writeBit.apply(this,arguments):"[object Array]"===Object.prototype.toString.call(t)&&t.length?this.writeBitArray.apply(this,arguments):"string"==typeof t?this.writeString.apply(this,arguments):"number"==typeof t?this.writeInteger.apply(this,arguments):this},n.toBinary=function(){for(var t=0,n=[],i=[];t<this.length;)n.push(parseInt(this.bitArray.slice(t,t+8).map(r.Intify).join(""),2)),n.length>=1024&&(i.push(String.fromCharCode.apply(String,n)),n=[]),t+=8;return i.join("")+String.fromCharCode.apply(String,n)},n.toString=function(){return this.bitArray.map(r.Intify).join("")},n.toDebug=function(t){var r=this.toString();t=t||1,r.length%32!==0&&(r+=new Array(32-r.length%32+1).join(" "));var n="\n",i="",e="",s="",a="",o="",h=!1;1&t&&(n+=" Bit"+new Array(61).join(" ")),2&t&&(n+="  U8  "),4&t&&(n+="  U16 "),n+="\n",1&t&&(n+=new Array(5).join(" |-------------|")),2&t&&(n+="      "),4&t&&(n+="      "),n+="\n";for(var u=0,g=r.length;g>u;u++){if((u+1)%32===0&&(h=!0),1&t&&(i+=this.currentOffset===u?"[":this.lastWrittenBegin===u?"<":this.lastWrittenEnd===u?">":" ",i+=r.charAt(u)),2&t&&(s+=r.charAt(u),8===s.length)){var l=parseInt(s,2);e+=l>32&&127>l?String.fromCharCode(l):".",s=""}if(4&t&&(o+=r.charAt(u),16===o.length)){var l=parseInt(o,2);a+=l>2048&&65535>l?String.fromCharCode(l):"..",o=""}h&&(1&t&&(i+=this.lastWrittenEnd===u+1?">":" ",n+=i,i=""),2&t&&(n+="  "+e,e=""),4&t&&(n+="  "+a,a=""),n+="\n"),h=!1}return n+="\n"},n.toHex=function(){for(var t=[],n=0,i=this.bitArray.length;i>n;n+=4){for(var e=0,s=0;4>s;s++)e+=r.Intify(this.bitArray[n+s])<<3-s;t.push(e.toString(16))}return t.join("")},n.mark=function(t){return t>-1&&(this.currentOffset=t>this.length?this.length:t),this},n.debug=function(t){t=t||1;var r=console.log.bind(console);return r(this.toString()+"\n ----------------------------------\n"+this.toDebug(t)),this},t});